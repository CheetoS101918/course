import pandas as pd
import sys


def show_variant_data_as_list(variant_number, file_path="dop_N_corrected.csv"):
    """
    –ó–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ CSV-—Ñ–∞–π–ª–∞, —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –∏—Ö –ø–æ –Ω–æ–º–µ—Ä—É –≤–∞—Ä–∏–∞–Ω—Ç–∞
    –∏ –≤—ã–≤–æ–¥–∏—Ç –∫–∞–∂–¥—É—é –∑–∞–ø–∏—Å—å –∫–∞–∫ —Å–ø–∏—Å–æ–∫ –≤ –∫–æ–Ω—Å–æ–ª—å.

    :param variant_number: –ù–æ–º–µ—Ä –≤–∞—Ä–∏–∞–Ω—Ç–∞ (—Ü–µ–ª–æ–µ —á–∏—Å–ª–æ), –∫–æ—Ç–æ—Ä—ã–π –Ω—É–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å.
    :param file_path: –ü—É—Ç—å –∫ CSV-—Ñ–∞–π–ª—É.
    """
    print("=" * 50)
    print(f"–ü–æ–∏—Å–∫ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –í–∞—Ä–∏–∞–Ω—Ç–∞ {variant_number} (–ø–æ—Å—Ç—Ä–æ—á–Ω—ã–π –≤—ã–≤–æ–¥)...")
    print("=" * 50)

    try:
        # 1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ CSV —Å —É–∫–∞–∑–∞–Ω–∏–µ–º —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—è (;)
        df = pd.read_csv(file_path, delimiter=';')

        # –£–¥–∞–ª–µ–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤ –≤ –Ω–∞–∑–≤–∞–Ω–∏—è—Ö —Å—Ç–æ–ª–±—Ü–æ–≤
        df.columns = df.columns.str.strip()

        variant_col_name = '–í–∞—Ä–∏–∞–Ω—Ç –∑–∞–¥–∞–Ω–∏—è'

        if variant_col_name in df.columns:
            # –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –∫–æ–ª–æ–Ω–∫–µ –∫ —Ü–µ–ª–æ–º—É —á–∏—Å–ª—É
            df[variant_col_name] = df[variant_col_name].astype(str).str.strip().astype(int)
        else:
            sys.exit(f"‚ùå –û—à–∏–±–∫–∞: –ö–æ–ª–æ–Ω–∫–∞ '{variant_col_name}' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ —Ñ–∞–π–ª–µ.")

        # 2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–º—É –Ω–æ–º–µ—Ä—É –≤–∞—Ä–∏–∞–Ω—Ç–∞
        filtered_df = df[df[variant_col_name] == variant_number]

        if filtered_df.empty:
            print(f"‚ùå –î–∞–Ω–Ω—ã–µ –¥–ª—è –í–∞—Ä–∏–∞–Ω—Ç–∞ {variant_number} –Ω–µ –Ω–∞–π–¥–µ–Ω—ã.")
            return

        # 3. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –≤—ã–≤–æ–¥—É

        # –ü–æ–ª—É—á–∞–µ–º –Ω–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –¥–ª—è –ø–æ–¥–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö
        columns = filtered_df.columns.tolist()

        print(f"‚úÖ –î–∞–Ω–Ω—ã–µ –¥–ª—è –í–∞—Ä–∏–∞–Ω—Ç–∞ {variant_number} (–°—Ç—Ä–æ–∫–∞ ‚Ññ - –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞: –ó–Ω–∞—á–µ–Ω–∏–µ):")
        print("-" * 70)

        # 4. –ü–æ—Å—Ç—Ä–æ—á–Ω—ã–π –≤—ã–≤–æ–¥
        for index, row in filtered_df.iterrows():
            print(f"üì¶ –ó–∞–ø–∏—Å—å ‚Ññ {index + 1}:")

            # –ò—Ç–µ—Ä–∞—Ü–∏—è –ø–æ –≤—Å–µ–º —Å—Ç–æ–ª–±—Ü–∞–º –¥–ª—è –≤—ã–≤–æ–¥–∞ –ø–∞—Ä—ã "–ù–∞–∑–≤–∞–Ω–∏–µ: –ó–Ω–∞—á–µ–Ω–∏–µ"
            for col in columns:
                # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤—ã–≤–æ–¥: –ù–∞–∑–≤–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–∞ (–±–µ–∑ –¥–≤–æ–µ—Ç–æ—á–∏—è) –∏ –∑–Ω–∞—á–µ–Ω–∏–µ (—Å –¥–≤–æ–µ—Ç–æ—á–∏–µ–º)
                print(f"  {col}: {row[col]}")

            print("-" * 70)


    except FileNotFoundError:
        sys.exit(f"‚ùå –û—à–∏–±–∫–∞: –§–∞–π–ª '{file_path}' –Ω–µ –Ω–∞–π–¥–µ–Ω. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å.")
    except Exception as e:
        sys.exit(f"‚ùå –ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö: {e}")


# --- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ ---

# **–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –≤–∞—Ä–∏–∞–Ω—Ç–∞:**
my_variant = 2


# –í—ã–∑–æ–≤ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤—ã–≤–æ–¥–∞ –¥–∞–Ω–Ω—ã—Ö
show_variant_data_as_list(my_variant)